{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/redex/environments/instagram/frontend/components/main/Profile.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport firebase from 'firebase';\nimport React, { useEffect, useState, Component } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Touchable from \"react-native-web/dist/exports/Touchable\";\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport { connect } from 'react-redux';\nimport { NickName, ProfileButton, ProfileButtonsContainer, UserProfileAvatar, UserProfileMainInfo } from \"../../Styles\";\nexport function Profile(props) {\n  var _this = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      userPosts = _useState4[0],\n      setUserPosts = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      contentIsLoaded = _useState6[0],\n      setContentIsLoaded = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      showLoadingScreen = _useState8[0],\n      setShowLoadingScreen = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      following = _useState10[0],\n      setFollowing = _useState10[1];\n\n  var FollowersPlaceholder = 1327026;\n  var FollowingPlaceholder = 4489;\n  var Thousand = 1000;\n  var Million = 1000000;\n  useEffect(function () {\n    var currentUser = props.currentUser,\n        posts = props.posts;\n\n    if (props.route.params.uid === firebase.auth().currentUser.uid) {\n      if (currentUser !== null) {\n        setContentIsLoaded(true);\n      }\n\n      setUser(currentUser);\n      setUserPosts(posts);\n    } else {\n      setContentIsLoaded(false);\n      firebase.firestore().collection(\"users\").doc(props.route.params.uid).get().then(function (snapshot) {\n        if (snapshot.exists) {\n          setUser(snapshot.data());\n        } else {\n          console.log(\"does not exist\");\n        }\n      });\n      firebase.firestore().collection(\"posts\").doc(props.route.params.uid).collection(\"userPosts\").orderBy(\"createdAt\", \"asc\").get().then(function (snapshot) {\n        var posts = snapshot.docs.map(function (doc) {\n          var data = doc.data();\n          var id = doc.id;\n          return _objectSpread({\n            id: id\n          }, data);\n        });\n        setUserPosts(posts);\n        setContentIsLoaded(true);\n      });\n\n      if (props.following.indexOf(props.route.params.uid) > -1) {\n        setFollowing(true);\n      } else {\n        setFollowing(false);\n      }\n    }\n  }, [props.route.params.uid, props.currentUser, props.posts, props.following]);\n\n  var onFollow = function onFollow() {\n    setShowLoadingScreen(false);\n    firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).set({});\n  };\n\n  var onUnfollow = function onUnfollow() {\n    setShowLoadingScreen(false);\n    firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).delete();\n  };\n\n  var onLogout = function onLogout() {\n    firebase.auth().signOut();\n  };\n\n  if (!contentIsLoaded && showLoadingScreen) {\n    return React.createElement(View, {\n      style: styles.indicator,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }\n    }, React.createElement(ActivityIndicator, {\n      size: \"large\",\n      color: \"black\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }\n    }));\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    styles: styles.userInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: {\n      flexDirection: \"row\",\n      alignItems: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, React.createElement(UserProfileAvatar, {\n    style: {\n      margin: 4,\n      marginLeft: 8\n    },\n    source: require(\"../../placeholder-images/Profile_avatar_placeholder_large.png\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 21\n    }\n  }), React.createElement(View, {\n    style: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 21\n    }\n  }, React.createElement(NickName, {\n    style: {\n      fontSize: 20,\n      marginBottom: 7\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }\n  }, user.name), React.createElement(View, {\n    style: {\n      width: \"100%\",\n      flexDirection: \"row\",\n      justifyContent: \"space-between\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 25\n    }\n  }, userPosts.length > Million ? React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 30\n    }\n  }, (userPosts.length / Million).toFixed(1), \"M Posts\") : userPosts.length > Thousand ? React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 30\n    }\n  }, (userPosts.length / Thousand).toFixed(1), \"K Posts\") : React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 30\n    }\n  }, userPosts.length, \" Posts\"), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 29\n    }\n  }, \"|\"), FollowersPlaceholder > Million ? React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 30\n    }\n  }, (FollowersPlaceholder / Million).toFixed(1), \"M Followers\") : FollowersPlaceholder > Thousand ? React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 30\n    }\n  }, (FollowersPlaceholder / Thousand).toFixed(1), \"K Followers\") : React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 30\n    }\n  }, FollowersPlaceholder, \" Followers\"), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 29\n    }\n  }, \"|\"), FollowingPlaceholder > Million ? React.createElement(Text, {\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 30\n    }\n  }, (FollowingPlaceholder / Million).toFixed(1), \"M Following\") : FollowingPlaceholder > Thousand ? React.createElement(Text, {\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 30\n    }\n  }, (FollowingPlaceholder / Thousand).toFixed(1), \"K Following\") : React.createElement(Text, {\n    style: {\n      marginRight: 8\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 30\n    }\n  }, FollowingPlaceholder, \" Following\"))))), props.route.params.uid !== firebase.auth().currentUser.uid ? React.createElement(ProfileButtonsContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 21\n    }\n  }, following ? React.createElement(ProfileButton, {\n    onPress: function onPress() {\n      return onUnfollow();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 27\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 33\n    }\n  }, \"Unfollow\")) : React.createElement(ProfileButton, {\n    onPress: function onPress() {\n      return onFollow();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 27\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 33\n    }\n  }, \"Follow\")), React.createElement(ProfileButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 25\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 29\n    }\n  }, \"Message\"))) : React.createElement(ProfileButtonsContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 20\n    }\n  }, React.createElement(ProfileButton, {\n    onPress: function onPress() {\n      return onLogout();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 25\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 29\n    }\n  }, \"Logout\")), React.createElement(ProfileButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 25\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 29\n    }\n  }, \"Statistic\"))), React.createElement(View, {\n    style: styles.userGallery,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  }, React.createElement(FlatList, {\n    numColumns: 3,\n    horizontal: false,\n    data: userPosts,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(View, {\n        style: styles.imageContainer,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }\n      }, React.createElement(Image, {\n        style: styles.image,\n        source: {\n          uri: item.downloadURL\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 25\n        }\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 17\n    }\n  })));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: 40\n  },\n  userInfo: {\n    margin: 20\n  },\n  userGallery: {\n    flex: 11\n  },\n  imageContainer: {\n    flex: 1 / 3\n  },\n  image: {\n    flex: 1,\n    aspectRatio: 1 / 1\n  },\n  indicator: {\n    flex: 1,\n    justifyContent: 'center'\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    currentUser: state.userState.currentUser,\n    posts: state.userState.posts,\n    following: state.userState.following\n  };\n};\n\nexport default connect(mapStateToProps, null)(Profile);","map":{"version":3,"sources":["/home/redex/environments/instagram/frontend/components/main/Profile.js"],"names":["firebase","React","useEffect","useState","Component","TouchableOpacity","connect","NickName","ProfileButton","ProfileButtonsContainer","UserProfileAvatar","UserProfileMainInfo","Profile","props","user","setUser","userPosts","setUserPosts","contentIsLoaded","setContentIsLoaded","showLoadingScreen","setShowLoadingScreen","following","setFollowing","FollowersPlaceholder","FollowingPlaceholder","Thousand","Million","currentUser","posts","route","params","uid","auth","firestore","collection","doc","get","then","snapshot","exists","data","console","log","orderBy","docs","map","id","indexOf","onFollow","set","onUnfollow","delete","onLogout","signOut","styles","indicator","container","userInfo","flexDirection","alignItems","margin","marginLeft","require","flex","fontSize","marginBottom","name","width","justifyContent","length","toFixed","marginRight","userGallery","item","imageContainer","image","uri","downloadURL","StyleSheet","create","marginTop","aspectRatio","mapStateToProps","state","userState"],"mappings":"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","sourcesContent":["import firebase from 'firebase';\nimport React, { useEffect, useState, Component } from 'react';\nimport { StyleSheet, View, Text, Image, FlatList, ActivityIndicator, Button, Touchable } from 'react-native';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport { connect } from 'react-redux';\nimport { NickName, ProfileButton, ProfileButtonsContainer, UserProfileAvatar, UserProfileMainInfo } from '../../Styles';\n\nexport function Profile(props){\n    const [user, setUser] = useState([])\n    const [userPosts, setUserPosts] = useState(null)\n    const [contentIsLoaded, setContentIsLoaded] = useState(false)\n    const [showLoadingScreen, setShowLoadingScreen] = useState(true)\n    const [following, setFollowing] = useState(false)\n    const FollowersPlaceholder = 1327026\n    const FollowingPlaceholder = 4489\n    const Thousand = 1000\n    const Million = 1000000\n\n    useEffect(() => {\n        const { currentUser, posts } = props\n        if (props.route.params.uid === firebase.auth().currentUser.uid){\n            if (currentUser !== null){\n                setContentIsLoaded(true)\n            }\n            setUser(currentUser)\n            setUserPosts(posts)\n        }\n        else{\n            setContentIsLoaded(false)\n            firebase.firestore()\n            .collection(\"users\")\n            .doc(props.route.params.uid)\n            .get()\n            .then((snapshot) => {\n                if(snapshot.exists){\n                    setUser(snapshot.data())\n                }\n                else {\n                    console.log(\"does not exist\")\n                }\n            })\n            firebase.firestore()\n            .collection(\"posts\")\n            .doc(props.route.params.uid)\n            .collection(\"userPosts\")\n            .orderBy(\"createdAt\", \"asc\")\n            .get()\n            .then((snapshot) => {\n                let posts = snapshot.docs.map(doc => {\n                    const data = doc.data()\n                    const id = doc.id\n                    return {id, ...data}\n                })\n                setUserPosts(posts)\n                setContentIsLoaded(true)\n            })\n            \n\n            if (props.following.indexOf(props.route.params.uid) > -1){\n                setFollowing(true)\n            }\n            else{\n                setFollowing(false)\n            }\n        }\n    }, [props.route.params.uid, props.currentUser, props.posts, props.following])\n\n    const onFollow = () => {\n        setShowLoadingScreen(false)\n        firebase.firestore()\n        .collection(\"following\")\n        .doc(firebase.auth().currentUser.uid)\n        .collection(\"userFollowing\")\n        .doc(props.route.params.uid)\n        .set({})\n    }\n\n    const onUnfollow = () => {\n        setShowLoadingScreen(false)\n        firebase.firestore()\n        .collection(\"following\")\n        .doc(firebase.auth().currentUser.uid)\n        .collection(\"userFollowing\")\n        .doc(props.route.params.uid)\n        .delete()\n    }\n\n    const onLogout = () => {\n        firebase.auth().signOut()\n    }\n\n    if(!contentIsLoaded && showLoadingScreen){\n        return(\n            <View style={styles.indicator}>\n                <ActivityIndicator \n                size='large' \n                color='black'\n                />\n            </View>\n        )\n    }\n    return (\n        <View style={styles.container}>\n            <View styles={styles.userInfo}>\n                <View style={{flexDirection:\"row\", alignItems:\"center\"}}>\n                    <UserProfileAvatar\n                        style={{\n                            margin:4,\n                            marginLeft:8\n                        }}\n                        source={require('../../placeholder-images/Profile_avatar_placeholder_large.png')}/>\n                    <View style={{flex:1}}>\n                        <NickName style={{fontSize:20, marginBottom:7}}>{user.name}</NickName>\n                        <View style={{\n                            width:\"100%\",\n                            flexDirection:\"row\",\n                            justifyContent:\"space-between\"}}>\n                            {userPosts.length > Million ?\n                            (<Text>{(userPosts.length/Million).toFixed(1)}M Posts</Text>) :\n                            userPosts.length > Thousand ?\n                            (<Text>{(userPosts.length/Thousand).toFixed(1)}K Posts</Text>) :\n                            (<Text>{userPosts.length} Posts</Text>)\n                            }\n                            <Text>|</Text>\n                            {FollowersPlaceholder > Million ? \n                            (<Text>{(FollowersPlaceholder/Million).toFixed(1)}M Followers</Text>) :\n                            FollowersPlaceholder > Thousand ?\n                            (<Text>{(FollowersPlaceholder/Thousand).toFixed(1)}K Followers</Text>) :\n                            (<Text>{FollowersPlaceholder} Followers</Text>)\n                            }\n                            <Text>|</Text>\n                            {FollowingPlaceholder > Million ? \n                            (<Text style={{marginRight:8}}>\n                                {(FollowingPlaceholder/Million).toFixed(1)}M Following</Text>) :\n                            FollowingPlaceholder > Thousand ?\n                            (<Text style={{marginRight:8}}>\n                                {(FollowingPlaceholder/Thousand).toFixed(1)}K Following</Text>) :\n                            (<Text style={{marginRight:8}}>\n                                {FollowingPlaceholder} Following</Text>)\n                            }\n                        </View>\n                    </View>\n                </View>\n            </View>\n            {props.route.params.uid !== firebase.auth().currentUser.uid ? ( \n                    <ProfileButtonsContainer>\n                        {following \n                        ?(<ProfileButton \n                            onPress={() => onUnfollow()}>\n                                <Text>Unfollow</Text>\n                            </ProfileButton>)\n                        :(<ProfileButton \n                            onPress={() => onFollow()}>\n                                <Text>Follow</Text>\n                            </ProfileButton>)}\n                        <ProfileButton>\n                            <Text>Message</Text>\n                        </ProfileButton>\n                    </ProfileButtonsContainer>) \n                : (<ProfileButtonsContainer>\n                        <ProfileButton onPress={() => onLogout()}>\n                            <Text>Logout</Text>\n                        </ProfileButton>\n                        <ProfileButton>\n                            <Text>Statistic</Text>\n                        </ProfileButton>\n                    </ProfileButtonsContainer>)\n                } \n            <View style={styles.userGallery}>\n                <FlatList\n                numColumns={3}\n                horizontal={false}\n                data={userPosts}\n                renderItem={({item}) => (\n                    <View style={styles.imageContainer}>\n                        <Image\n                        style={styles.image} \n                        source={{uri: item.downloadURL}}/>\n                    </View>\n                )}/>\n            </View>\n        </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        marginTop: 40\n    },\n    userInfo: {\n        margin: 20\n    },\n    userGallery: {\n        flex: 11\n    },\n    imageContainer:{\n        flex: 1/3\n    },\n    image:{\n        flex:1,\n        aspectRatio: 1/1\n    },\n    indicator:{\n        flex:1, \n        justifyContent: 'center'\n    }\n})\nconst mapStateToProps = (state) => ({\n    currentUser: state.userState.currentUser,\n    posts: state.userState.posts,\n    following: state.userState.following\n})\n\nexport default connect(mapStateToProps, null)(Profile)"]},"metadata":{},"sourceType":"module"}